'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
var express = require('express');
var morgan = require('morgan');
var bodyParser = require('body-parser');
var compression = require('compression');
var proxy = require('http-proxy-middleware');

function staticLoader(app, options) {
  var clientBuildPath = options.clientBuildPath;


  app.use(compression());
  app.use(bodyParser.json());
  app.use(bodyParser.urlencoded({ extended: false }));
  app.use(morgan('combined'));

  // Serve static assets
  if (process.env.NODE_ENV === 'development') {
    // Connect proxy to Create React App dev server
    var _proxy = require('http-proxy-middleware');
    app.use(['**/*.*', '/static', '/sockjs-node'], _proxy({
      target: 'http://localhost:3000',
      changeOrigin: true,
      ws: true
    }));
    console.log('Connected to CRA Client dev server');
  } else {
    app.use(express.static(clientBuildPath, { index: false }));
  }

  return app;
}

exports.default = staticLoader;